# Крива на Безие

##### Никола Георгиев, 4MI0600288

---

## 1. Теоретична част

### 1.1 Същност и цел на алгоритъма

Кривите на Bezier са параметрични криви, широко използвани в компютърната графика, CAD системи и анимация. Те се дефинират чрез набор от контролни точки (b_i, i = 0,...,n) и интервал ([0,1]). Контролните точки определят формата на кривата, като крива „следва“ тези точки, но не е задължително да преминава през всички тях, освен първата и последната.

Чрез кривите на Bezier можем да описваме гладка и контролирана форма, която е лесно модифицируема чрез преместване на контролните точки.

Често е необходимо да разглеждаме **част от кривата**. За параметър (c \in (0,1)) частта на кривата, съответстваща на интервала ([0,c]) или ([c,1]), също е крива на Bezier. **Subdivision (подразделяне)** на кривата позволява да намерим новите контролни точки за тези части.

Идеята е проста: алгоритъмът на de Casteljau, който изчислява точките по кривата, автоматично генерира и новите контролни точки за лявото и дясното подразделение на кривата. Тези точки се извеждат от таблицата на алгоритъма, използвана за изчисление на кривата.

```
Контролните полигони (удебелени в зелено и червено) на крива на Bezier за c = 0.5
```

---

### 1.2 Алгоритъм на de Casteljau

Алгоритъмът на de Casteljau изчислява точка на кривата за дадена стойност на параметъра (t \in [0,1]) чрез **последователни линейни интерполации** между контролни точки.

Нека имаме контролни точки (b_0, b_1, ..., b_n). Поставяме (b_i^0 = b_i) и изчисляваме нови точки рекурсивно:

[
b_i^r(t) = (1-t) , b_i^{r-1} + t , b_{i+1}^{r-1}, \quad r = 1,...,n; , i = 0,...,n-r
]

* **Начална стъпка:** (b_i^0 = b_i), това са оригиналните контролни точки.
* **Следващи стъпки:** всяка нова точка се получава чрез линейна комбинация на две точки от предходния ред.

След като таблицата се попълни, точката на кривата при параметър (t) е (b_0^n(t)).

---

### 1.3 Subdivision (Подразделяне)

Subdivision методът позволява да разделим кривата на две части за дадена стойност (c \in (0,1)):

1. **Ляво подразделение:** частта на кривата ([0,c]) се определя чрез точките по „хипотенузата“ на таблицата на de Casteljau.
2. **Дясно подразделение:** частта на кривата ([c,1]) се определя чрез точките по долния катет на таблицата.

Така получаваме нови контролните полигони за всяка част от кривата, без да се налага допълнително изчисление. Това е ефективен и стабилен метод за:

* Разрязване на криви на Bezier.
* Рисуване на части от кривата.
* Анимации и графични приложения, където се изисква частично манипулиране на кривата.

```
Илюстрация на таблицата на de Casteljau за subdivision:
- Зелените точки: контролни точки за лявото подразделение
- Червените точки: контролни точки за дясното подразделение
```

---

## 2. Описание на приложението

### 2.1 Цел и функционалност

Приложението реализира интерактивно рисуване на криви на Bezier с `<canvas>` и JavaScript. Основните функционалности са:

* Добавяне на контролни точки чрез клик върху платното.
* Преместване на контролни точки чрез плъзгане с мишката.
* Визуализиране на кривата на Bezier чрез чекбокс „Show/Hide“.
* Бутон за стъпка назад (Undo) и бутон за започване отначало (Fresh).
* Слайдър позволява динамично показване на междинни точки по алгоритъма на de Casteljau.

---

### 2.2 Структура на кода

**Основен клас на приложението** съдържа:

* Списък с контролни точки `pts`.
* Параметър `t`, който определя позицията за визуализация на De Casteljau.
* Флаг `showBezier` за показване/скриване на кривата.
* Методи за рисуване:

  * `calc(p0, p1, t)` – линейна интерполация между две точки.
  * `dcslj(t, pts)` – рекурсивно изчисление на точка на кривата.
  * `drawpts` и `drawLines` – визуализация на контролни точки и линии.
  * `drawBezierCurve` – чертаене на самата крива на Bezier.

**Събития:**

* `mousedown`, `mousemove`, `mouseup` – плъзгане на контролни точки.
* `click` – добавяне на нови точки.
* `input` (slider) – промяна на `t`.
* `change` (checkbox) – показване/скриване на кривата.
* `click` (бутоните) – изтриване на последна точка или на всички точки.

---

### 2.3 Визуализация

* Контролните точки са **зелени**.
* Линиите между контролните точки са **зелени**.
* Междинните точки, изчислени от алгоритъма на de Casteljau, са **сини**.
* Кривата на Bezier е **червена** и се показва само когато е активиран чекбоксът.

---

### 2.4 Интерактивна работа

1. Кликнете върху canvas, за да добавите точки.
2. Плъзнете точки с мишката, за да промените формата на кривата.
3. Активирайте чекбокс „Show/Hide“, за да видите кривата на Bezier.
4. Използвайте слайдера, за да наблюдавате междинните точки при различни стойности на `t`.
5. Бутоните „Fresh“ и „Back“ позволяват изчистване на всички точки или изтриване на последната точка.

---

### 2.5 Заключение

Приложението демонстрира интерактивното използване на алгоритъма на de Casteljau и subdivision метода за криви на Bezier. С него се илюстрират както контролните полигони, така и междинните точки, което прави процеса на обучение и визуализация ясен и интуитивен.



Изготвеното приложение цели да онагледи subdivision алгоритъма и
прилагането му. То е web базирано. Написано е изцяло с web технологии – HTML,
CSS, JavaScript. Приложението е интерактивно. Включва лесен за използване
потребителски интерфейс.

Приложението предоставя визуализация на получените от subdivision и de
Casteljau контролни точки и контролни полигони.


С клик върху бялото платно потребителят може да поставя произволно
контролни точки, необходими за построяване на криви на Bezier. В случай на
допусната грешка може да бъде премахната последната поставена точка или
цялото платно да бъде изчистено.


Визуализацията на кривата на Bezier се контролира от checkbox-ът под
бутоните. В случай че потребителят е скрил кривата, се показват единствено
контролните точки и полигони.

Отношението, в което отсечките, образувани между две съседни контролни
точки, може да се регулира от slider-а най-долу в екрана. По-подразбиране
делението е в отношение 1:1.


